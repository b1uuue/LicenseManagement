<!DOCTYPE html>
<html>
<head>
    <title>License overview</title>
    <link rel="stylesheet" href="style/Reset.css">
    <link rel="stylesheet" href="style/BasicStyle.css">
</head>
<body>
<div id="Header"></div>
<div class="main">
    <div class="main-container">
        <div id="LeftBar" class="left-bar"></div
        ><div class="basic-main">
            <div class="bm-header">
                <span class="bm-title">License Overview</span>
            </div>
            <div id="LicenseOverview">
                <div class="bm-content">
                    <div class="license-overview-count">
                        <span class="title-note">Total activate licenses:</span>
                        <span class="title-note" id="LOTotalNumber">30</span>
                    </div>
                    <div class="license-overview-form" id="LOForm">
                        <table class="form">
                            <tbody>
                            <tr class="form-head">
                                <td>License Key</td>
                                <td>Quota</td>
                                <td>Used</td>
                                <td>Product and Type</td>
                                <td>Expiration Date</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="page-control">
                        <input id="PCPage" class="pc-page" type="number" placeholder="page">
                        <button id="PCGo" class="pc-go">go</button>
                        <button id="PCBack" class="pc-back"></button>
                        <span class="pc-page-current">2</span><span class="pc-page-divide">/</span><span
                            class="pc-page-total">10</span>
                        <button id="PCNext" class="pc-next"></button>
                    </div>
                </div>
            </div>

            <div id="ss" class="test">
                <li>foo</li>
                <li>bar</li>
            </div>
        </div>
    </div>
</div>

<script src="script/jquery-1.12.4.min.js"></script>
<script src="script/script.js"></script>
<script>
    var testArr = $.ajax({
        type: 'POST',
        data: JSON.stringify({"method": "listlicense"}),
        dataType: 'json',
        url: 'https://127.0.0.1:8889/',
        success: function (data, status) {
            updateLOForm(data, status)
        }
    });

    function updateLOForm(data, status) {
        let pageNum = parseInt(data.license.length / 5);
        let pageLes = data.license.length % 5
        let pageBuffer = 0;
        if (status == 'success') {
            for (let i = 0; i < 5; i++) {
                console.log(pageBuffer * 5 + pageLes);

                if ((pageBuffer * 5 + pageLes) < i+1) {
                    $('#LOForm tbody').append('<tr class="form-body">' + '<td></td><td></td><td></td><td></td><td></td>' + '</tr>')
                }
                else {
                    //get expiration date
                    let _expirationDate = timestampToDate(data.license[i].activetime);
                    //load form
                    $('#LOForm tbody').append('<tr class="form-body">' +
                        '<td>' + data.license[i].licensekey + '</td>' +
                        '<td>' + data.license[i].quota + '</td>' +
                        '<td>' + data.license[i].used + '</td>' +
                        '<td>' + data.license[i].producttype + '</td>' +
                        '<td>' + _expirationDate + '</td>' + '</tr>'
                    );
                }
            }

        }
    }


</script>
</body>
</html>

